Imports done
SAM initialized
Start training
Loading train data...
Loaded train data.
56.32676315307617 GB
Loading val data...
Loaded val data.
57.65282440185547 GB
<class 'segment_anything.modeling.mask_decoder.MaskDecoder'>
  0%|          | 0/1054 [00:00<?, ?it/s]/ceph/home/liuxingyu/miniconda3/envs/SAM/lib/python3.8/site-packages/torch/nn/functional.py:1639: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
  0%|          | 1/1054 [00:02<43:26,  2.48s/it]  0%|          | 2/1054 [00:03<29:18,  1.67s/it]  0%|          | 3/1054 [00:04<23:02,  1.32s/it]  0%|          | 4/1054 [00:05<19:50,  1.13s/it]  0%|          | 5/1054 [00:06<17:34,  1.01s/it]  1%|          | 6/1054 [00:06<16:16,  1.07it/s]  1%|          | 7/1054 [00:07<15:03,  1.16it/s]  1%|          | 8/1054 [00:08<13:46,  1.27it/s]  1%|          | 9/1054 [00:08<12:43,  1.37it/s]  1%|          | 10/1054 [00:09<11:56,  1.46it/s]  1%|          | 11/1054 [00:10<11:23,  1.52it/s]  1%|          | 12/1054 [00:10<11:08,  1.56it/s]  1%|          | 13/1054 [00:11<10:51,  1.60it/s]  1%|▏         | 14/1054 [00:11<10:40,  1.62it/s]  1%|▏         | 15/1054 [00:12<10:29,  1.65it/s]  2%|▏         | 16/1054 [00:13<11:22,  1.52it/s]  2%|▏         | 17/1054 [00:13<11:24,  1.52it/s]  2%|▏         | 18/1054 [00:14<11:16,  1.53it/s]  2%|▏         | 19/1054 [00:15<11:17,  1.53it/s]  2%|▏         | 20/1054 [00:15<11:23,  1.51it/s]  2%|▏         | 21/1054 [00:16<11:06,  1.55it/s]  2%|▏         | 22/1054 [00:17<11:20,  1.52it/s]  2%|▏         | 23/1054 [00:17<11:25,  1.50it/s]  2%|▏         | 24/1054 [00:18<11:12,  1.53it/s]  2%|▏         | 25/1054 [00:19<10:54,  1.57it/s]  2%|▏         | 26/1054 [00:19<10:35,  1.62it/s]  3%|▎         | 27/1054 [00:20<10:26,  1.64it/s]  3%|▎         | 28/1054 [00:20<10:16,  1.66it/s]  3%|▎         | 29/1054 [00:21<10:05,  1.69it/s]  3%|▎         | 30/1054 [00:21<09:50,  1.73it/s]  3%|▎         | 31/1054 [00:22<09:47,  1.74it/s]  3%|▎         | 32/1054 [00:22<09:37,  1.77it/s]  3%|▎         | 33/1054 [00:23<09:39,  1.76it/s]  3%|▎         | 34/1054 [00:24<09:33,  1.78it/s]  3%|▎         | 35/1054 [00:24<09:26,  1.80it/s]  3%|▎         | 36/1054 [00:25<09:29,  1.79it/s]  4%|▎         | 37/1054 [00:25<09:22,  1.81it/s]  4%|▎         | 38/1054 [00:26<09:22,  1.81it/s]  4%|▎         | 39/1054 [00:26<09:14,  1.83it/s]  4%|▍         | 40/1054 [00:27<09:15,  1.83it/s]  4%|▍         | 41/1054 [00:27<09:17,  1.82it/s]  4%|▍         | 42/1054 [00:28<09:15,  1.82it/s]  4%|▍         | 43/1054 [00:29<09:15,  1.82it/s]  4%|▍         | 44/1054 [00:29<09:16,  1.81it/s]  4%|▍         | 45/1054 [00:30<09:09,  1.83it/s]  4%|▍         | 46/1054 [00:30<09:09,  1.84it/s]  4%|▍         | 47/1054 [00:31<09:10,  1.83it/s]  5%|▍         | 48/1054 [00:31<09:15,  1.81it/s]  5%|▍         | 49/1054 [00:32<09:23,  1.78it/s]  5%|▍         | 50/1054 [00:32<09:28,  1.77it/s]  5%|▍         | 51/1054 [00:33<09:29,  1.76it/s]  5%|▍         | 52/1054 [00:34<09:47,  1.71it/s]  5%|▌         | 53/1054 [00:34<10:07,  1.65it/s]  5%|▌         | 54/1054 [00:35<10:14,  1.63it/s]  5%|▌         | 55/1054 [00:36<10:21,  1.61it/s]  5%|▌         | 56/1054 [00:36<10:23,  1.60it/s]  5%|▌         | 57/1054 [00:37<10:24,  1.60it/s]  6%|▌         | 58/1054 [00:37<10:27,  1.59it/s]  6%|▌         | 59/1054 [00:38<10:28,  1.58it/s]  6%|▌         | 60/1054 [00:39<10:22,  1.60it/s]  6%|▌         | 61/1054 [00:39<10:43,  1.54it/s]  6%|▌         | 62/1054 [00:40<11:09,  1.48it/s]  6%|▌         | 63/1054 [00:41<11:29,  1.44it/s]  6%|▌         | 64/1054 [00:42<12:14,  1.35it/s]  6%|▌         | 65/1054 [00:43<12:45,  1.29it/s]  6%|▋         | 66/1054 [00:44<14:55,  1.10it/s]  6%|▋         | 67/1054 [00:45<15:28,  1.06it/s]  6%|▋         | 68/1054 [00:46<15:04,  1.09it/s]  7%|▋         | 69/1054 [00:47<14:35,  1.13it/s]  7%|▋         | 70/1054 [00:48<14:59,  1.09it/s]  7%|▋         | 71/1054 [00:48<13:56,  1.18it/s]  7%|▋         | 72/1054 [00:49<13:07,  1.25it/s]  7%|▋         | 73/1054 [00:50<12:30,  1.31it/s]  7%|▋         | 74/1054 [00:50<11:58,  1.36it/s]  7%|▋         | 75/1054 [00:51<11:15,  1.45it/s]  7%|▋         | 76/1054 [00:51<10:50,  1.50it/s]  7%|▋         | 77/1054 [00:52<10:24,  1.56it/s]  7%|▋         | 78/1054 [00:53<10:07,  1.61it/s]  7%|▋         | 79/1054 [00:53<09:55,  1.64it/s]  8%|▊         | 80/1054 [00:54<09:49,  1.65it/s]  8%|▊         | 81/1054 [00:54<09:49,  1.65it/s]  8%|▊         | 82/1054 [00:55<09:51,  1.64it/s]  8%|▊         | 83/1054 [00:56<09:51,  1.64it/s]  8%|▊         | 84/1054 [00:56<09:49,  1.65it/s]  8%|▊         | 85/1054 [00:57<09:48,  1.65it/s]  8%|▊         | 86/1054 [00:58<10:16,  1.57it/s]  8%|▊         | 87/1054 [00:58<10:12,  1.58it/s]  8%|▊         | 88/1054 [00:59<09:48,  1.64it/s]  8%|▊         | 89/1054 [00:59<09:30,  1.69it/s]  9%|▊         | 90/1054 [01:00<09:17,  1.73it/s]  9%|▊         | 91/1054 [01:00<09:08,  1.76it/s]  9%|▊         | 92/1054 [01:01<09:08,  1.76it/s]  9%|▉         | 93/1054 [01:01<09:06,  1.76it/s]  9%|▉         | 94/1054 [01:02<09:02,  1.77it/s]  9%|▉         | 95/1054 [01:03<09:03,  1.77it/s]  9%|▉         | 96/1054 [01:03<08:57,  1.78it/s]  9%|▉         | 97/1054 [01:04<08:59,  1.77it/s]  9%|▉         | 98/1054 [01:04<08:56,  1.78it/s]  9%|▉         | 99/1054 [01:05<08:55,  1.78it/s]  9%|▉         | 100/1054 [01:05<08:58,  1.77it/s] 10%|▉         | 101/1054 [01:06<08:56,  1.78it/s] 10%|▉         | 102/1054 [01:07<08:59,  1.77it/s] 10%|▉         | 103/1054 [01:07<09:04,  1.75it/s] 10%|▉         | 104/1054 [01:08<09:04,  1.74it/s] 10%|▉         | 105/1054 [01:08<09:03,  1.75it/s] 10%|█         | 106/1054 [01:09<09:22,  1.68it/s] 10%|█         | 107/1054 [01:10<09:37,  1.64it/s] 10%|█         | 108/1054 [01:10<09:45,  1.62it/s] 10%|█         | 109/1054 [01:11<09:58,  1.58it/s] 10%|█         | 110/1054 [01:12<10:12,  1.54it/s] 11%|█         | 111/1054 [01:12<10:25,  1.51it/s] 11%|█         | 112/1054 [01:13<10:26,  1.50it/s] 11%|█         | 113/1054 [01:14<10:23,  1.51it/s] 11%|█         | 114/1054 [01:14<10:30,  1.49it/s] 11%|█         | 115/1054 [01:15<10:52,  1.44it/s] 11%|█         | 116/1054 [01:16<11:07,  1.40it/s] 11%|█         | 117/1054 [01:17<11:36,  1.35it/s] 11%|█         | 118/1054 [01:17<11:57,  1.30it/s] 11%|█▏        | 119/1054 [01:18<12:24,  1.26it/s] 11%|█▏        | 120/1054 [01:20<15:54,  1.02s/it] 11%|█▏        | 121/1054 [01:21<15:15,  1.02it/s] 12%|█▏        | 122/1054 [01:22<14:36,  1.06it/s] 12%|█▏        | 123/1054 [01:22<13:59,  1.11it/s] 12%|█▏        | 124/1054 [01:23<13:17,  1.17it/s] 12%|█▏        | 125/1054 [01:24<12:49,  1.21it/s] 12%|█▏        | 126/1054 [01:25<12:25,  1.24it/s] 12%|█▏        | 127/1054 [01:25<12:11,  1.27it/s] 12%|█▏        | 128/1054 [01:26<12:00,  1.29it/s] 12%|█▏        | 129/1054 [01:27<11:35,  1.33it/s] 12%|█▏        | 130/1054 [01:28<11:32,  1.34it/s] 12%|█▏        | 131/1054 [01:28<11:10,  1.38it/s] 13%|█▎        | 132/1054 [01:29<11:00,  1.40it/s] 13%|█▎        | 133/1054 [01:30<10:37,  1.44it/s] 13%|█▎        | 134/1054 [01:30<10:15,  1.49it/s] 13%|█▎        | 135/1054 [01:31<10:02,  1.53it/s] 13%|█▎        | 136/1054 [01:31<09:46,  1.57it/s] 13%|█▎        | 137/1054 [01:32<09:29,  1.61it/s] 13%|█▎        | 138/1054 [01:33<09:18,  1.64it/s] 13%|█▎        | 139/1054 [01:33<09:13,  1.65it/s] 13%|█▎        | 140/1054 [01:34<09:11,  1.66it/s] 13%|█▎        | 141/1054 [01:34<09:04,  1.68it/s] 13%|█▎        | 142/1054 [01:35<08:59,  1.69it/s] 14%|█▎        | 143/1054 [01:36<08:56,  1.70it/s] 14%|█▎        | 144/1054 [01:36<08:44,  1.73it/s] 14%|█▍        | 145/1054 [01:37<08:37,  1.76it/s] 14%|█▍        | 146/1054 [01:37<08:37,  1.76it/s] 14%|█▍        | 147/1054 [01:38<08:32,  1.77it/s] 14%|█▍        | 148/1054 [01:38<08:34,  1.76it/s] 14%|█▍        | 149/1054 [01:39<08:32,  1.77it/s] 14%|█▍        | 150/1054 [01:39<08:21,  1.80it/s] 14%|█▍        | 151/1054 [01:40<08:18,  1.81it/s] 14%|█▍        | 152/1054 [01:40<08:15,  1.82it/s] 15%|█▍        | 153/1054 [01:41<08:14,  1.82it/s] 15%|█▍        | 154/1054 [01:42<08:13,  1.82it/s] 15%|█▍        | 155/1054 [01:42<08:13,  1.82it/s] 15%|█▍        | 156/1054 [01:43<08:13,  1.82it/s] 15%|█▍        | 157/1054 [01:43<08:12,  1.82it/s] 15%|█▍        | 158/1054 [01:44<08:13,  1.81it/s] 15%|█▌        | 159/1054 [01:44<08:11,  1.82it/s] 15%|█▌        | 160/1054 [01:45<08:21,  1.78it/s] 15%|█▌        | 161/1054 [01:46<08:27,  1.76it/s] 15%|█▌        | 162/1054 [01:46<08:31,  1.75it/s] 15%|█▌        | 163/1054 [01:47<08:45,  1.70it/s] 16%|█▌        | 164/1054 [01:47<08:54,  1.67it/s] 16%|█▌        | 165/1054 [01:48<08:58,  1.65it/s] 16%|█▌        | 166/1054 [01:49<09:02,  1.64it/s] 16%|█▌        | 167/1054 [01:49<09:03,  1.63it/s] 16%|█▌        | 168/1054 [01:50<09:07,  1.62it/s] 16%|█▌        | 169/1054 [01:50<09:11,  1.61it/s] 16%|█▌        | 170/1054 [01:51<09:20,  1.58it/s] 16%|█▌        | 171/1054 [01:52<09:32,  1.54it/s] 16%|█▋        | 172/1054 [01:53<09:54,  1.48it/s] 16%|█▋        | 173/1054 [01:53<10:01,  1.46it/s] 17%|█▋        | 174/1054 [01:54<10:02,  1.46it/s] 17%|█▋        | 175/1054 [01:55<10:02,  1.46it/s] 17%|█▋        | 176/1054 [01:55<09:56,  1.47it/s] 17%|█▋        | 177/1054 [01:56<09:58,  1.47it/s] 17%|█▋        | 178/1054 [01:57<09:58,  1.46it/s] 17%|█▋        | 179/1054 [01:57<09:59,  1.46it/s] 17%|█▋        | 180/1054 [01:58<10:00,  1.46it/s] 17%|█▋        | 181/1054 [01:59<09:53,  1.47it/s] 17%|█▋        | 182/1054 [01:59<09:56,  1.46it/s] 17%|█▋        | 183/1054 [02:00<09:56,  1.46it/s] 17%|█▋        | 184/1054 [02:01<09:55,  1.46it/s] 18%|█▊        | 185/1054 [02:01<09:54,  1.46it/s] 18%|█▊        | 186/1054 [02:02<10:02,  1.44it/s] 18%|█▊        | 187/1054 [02:03<10:33,  1.37it/s] 18%|█▊        | 188/1054 [02:04<11:46,  1.23it/s] 18%|█▊        | 189/1054 [02:05<12:46,  1.13it/s] 18%|█▊        | 190/1054 [02:06<13:27,  1.07it/s] 18%|█▊        | 191/1054 [02:07<13:58,  1.03it/s] 18%|█▊        | 192/1054 [02:08<13:48,  1.04it/s] 18%|█▊        | 193/1054 [02:09<12:49,  1.12it/s] 18%|█▊        | 194/1054 [02:10<11:57,  1.20it/s] 19%|█▊        | 195/1054 [02:10<11:16,  1.27it/s] 19%|█▊        | 196/1054 [02:11<10:48,  1.32it/s] 19%|█▊        | 197/1054 [02:12<10:22,  1.38it/s] 19%|█▉        | 198/1054 [02:12<10:00,  1.43it/s] 19%|█▉        | 199/1054 [02:13<09:43,  1.47it/s] 19%|█▉        | 200/1054 [02:13<09:20,  1.52it/s] 19%|█▉        | 201/1054 [02:14<09:02,  1.57it/s] 19%|█▉        | 202/1054 [02:15<08:51,  1.60it/s] 19%|█▉        | 203/1054 [02:15<08:40,  1.63it/s] 19%|█▉        | 204/1054 [02:16<08:34,  1.65it/s] 19%|█▉        | 205/1054 [02:16<08:30,  1.66it/s] 20%|█▉        | 206/1054 [02:17<08:24,  1.68it/s]slurmstepd: error: *** JOB 8066 ON node007 CANCELLED AT 2023-06-17T11:21:30 ***
